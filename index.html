<script>
    const ws = new WebSocket('ws://scoreboard4.glitch.me');

    ws.onopen = () => {
        console.log('WebSocket connection established');
    };

    ws.onmessage = (event) => {
        console.log('Received command:', event.data);

        switch (event.data) {
            case 'left':
                platformX -= 10;
                break;
            case 'right':
                platformX += 10;
                break;
            default:
                console.log('Unknown command:', event.data);
                break;
        }
        
        // Plattform innerhalb der Grenzen halten
        if (platformX < 0) platformX = 0;
        if (platformX > canvas.width - PLATFORM_WIDTH) platformX = canvas.width - PLATFORM_WIDTH;
    };

    ws.onerror = (error) => {
        console.error('WebSocket error:', error);
    };

    ws.onclose = () => {
        console.log('WebSocket connection closed');
    };

    function draw() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        ctx.fillStyle = bgColor;
        ctx.fillRect(0, 0, canvas.width, canvas.height);
        drawBall(ballX, ballY, ballColor);
        secondBalls.forEach(ball => drawBall(ball.x, ball.y, secondBallColor));
        if (goldenBallActive) {
            drawBall(goldenBallX, goldenBallY, goldenBallColor);
        }
        drawPlatform();
        ctx.drawImage(img, imgX, 0, BALL_SIZE * 5, BALL_SIZE * 5);
        if (isGameOver) {
            if (score >= WINNING_SCORE) {
                drawWinScreen();
            } else {
                drawGameOver();
            }
        }
    }

    function gameLoop() {
        update();
        draw();
        requestAnimationFrame(gameLoop);
    }

    // Starte das Spiel
    resetGame();
    gameLoop();
</script>
